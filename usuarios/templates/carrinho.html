{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carrinho</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/images/favicons/apple-touch-icon.png' %}" />
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'assets/images/favicons/favicon-32x32.png' %}" />
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'assets/images/favicons/favicon-16x16.png' %}" />
    <link rel="manifest" href="{% static 'assets/images/favicons/site.webmanifest' %}" />
    <meta name="description" content="Qrowd HTML 5 Template" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&amp;display=swap" rel="stylesheet" />

    <!-- Vendor CSS Files -->
    <link rel="stylesheet" href="{% static 'assets/vendors/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/animate/animate.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/fontawesome/css/all.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/jarallax/jarallax.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/jquery-magnific-popup/jquery.magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/nouislider/nouislider.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/odometer/odometer.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/swiper/swiper.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/owl-carousel/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/bootstrap-select/css/bootstrap-select.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/jquery-ui/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/timepicker/timePicker.css' %}">

    <!-- Template Styles -->
    <link rel="stylesheet" href="{% static 'assets/css/qrowd.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/qrowd-responsive.css' %}">
</head>

<body class="custom-cursor">

    <!-- Preloader -->
    <div class="preloader">
        <div class="preloader__image"></div>
    </div>

    <!-- Page Wrapper -->
    <div class="page-wrapper">

        <!-- Sticky Header -->
        <div class="stricky-header stricked-menu main-menu">
            <div class="sticky-header__content"></div>
        </div>

        <!-- Page Header -->
        <section class="page-header">
            <div class="page-header-bg" style="background-image: url('{% static 'assets/images/backgrounds/page-header-bg.jpg' %}')"></div>
            <div class="page-header-shape-1 float-bob-x">
                <img src="{% static 'assets/images/shapes/page-header-shape-1.png' %}" alt="">
            </div>
            <div class="page-header-shape-2 float-bob-y">
                <img src="{% static 'assets/images/shapes/page-header-shape-2.png' %}" alt="">
            </div>
            <div class="page-header-shape-3 float-bob-x">
                <img src="{% static 'assets/images/shapes/page-header-shape-3.png' %}" alt="">
            </div>
            <div class="container">
                <div class="page-header__inner">
                    <ul class="thm-breadcrumb list-unstyled">
                        <li><a href="index.html">Cliente</a></li>
                        <li><span>/</span></li>
                        <li>Carrinho</li>
                    </ul>
                    <h2>Meu Carrinho</h2>
                </div>
            </div>
        </section>

        <!-- Carrinho -->
        {% if itens %}
        <section class="cart-page">
            <div class="container">
                <div class="table-responsive">
                    <table class="table cart-table">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Preço</th>
                                <th>Quantidade</th>
                                <th>Total</th>
                                <th>Remover</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in itens %}
                                <tr>
                                    <td>
                                        <div class="product-box">
                                            <div class="img-box">
                                                <img src="{{ item.produto.imagem.url }}" alt="{{ item.produto.nome }}" style="width: 100px; height: auto;">
                                            </div>
                                            <h3><a href="#">{{ item.produto.nome }}</a></h3>
                                        </div>
                                    </td>
                                    <td>Kz {{ item.produto.preco|floatformat:2 }}</td>
                                    <td>
                                        <div class="quantity-box">
                                            <button type="button" class="sub"><i class="fa fa-minus"></i></button>
                                            <input type="number" id="produto-{{ item.produto.id }}" value="{{ item.quantidade }}" />
                                            <button type="button" class="add"><i class="fa fa-plus"></i></button>
                                        </div>
                                    </td>
                                    <td>Kz {{ item.produto.preco|floatformat:2 }}</td>
                                    <td>
                                        <div class="cross-icon">
                                            <a href="#" class="fa fa-times remove-icon"></a>
                                        </div>
                                    </td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="5">Seu carrinho está vazio.</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Subtotal, Envio e Total -->
                <div class="row">
                    
                    <div class="col-xl-4 col-lg-5">
                        <ul class="cart-total list-unstyled">
                            <li>
                                <span>Subtotal</span>
                                <span>Kz {{ subtotal|floatformat:2 }}</span>
                            </li>
                            <li>
                                <span>Envio</span>
                                <span>Kz 0.00</span>
                            </li>
                            <li>
                                <span>Total</span>
                                <span class="cart-total-amount">kz {{ total|floatformat:2 }}</span>
                            </li>
                        </ul>
                        
                    </div>
                </div>

                <div class="fixed-cart__footer">
                    <div class="fixed-cart__form">
                        <hr>
                        <h3>Endereço</h3>
                        <form method="post" action="{% url 'finalizar_compra' %}">
                            {% csrf_token %}
                            <div class="card">
                                
                                <div class="card-body">
                                    {{ form.non_field_errors }}
                                    <div class="form-group">
                                        {{ form.endereco.label_tag }}
                                        {{ form.endereco }}
                                        {{ form.endereco.errors }}
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-block">Finalizar Compra</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        {% else %}
        <section class="cart-page">
            <div class="container">
                <p>Seu carrinho está vazio.</p>
            </div>
        </section>
        {% endif %}

    </div>

    <!-- Mobile Nav -->
    <div class="mobile-nav__wrapper">
        <div class="mobile-nav__overlay mobile-nav__toggler"></div>
        <div class="mobile-nav__content">
            <span class="mobile-nav__close mobile-nav__toggler"><i class="fa fa-times"></i></span>
            <div class="logo-box">
                <a href="index.html" aria-label="logo image"><img src="{% static 'assets/images/resources/logo-2.png' %}" width="143" alt="" /></a>
            </div>
            <ul class="mobile-nav__contact list-unstyled">
                <li><i class="fa fa-envelope"></i><a href="mailto:needhelp@qrowd.com">needhelp@qrowd.com</a></li>
                <li><i class="fa fa-phone-alt"></i><a href="tel:666-888-0000">666 888 0000</a></li>
            </ul>
            <div class="mobile-nav__top">
                <div class="mobile-nav__social">
                    <a href="#" class="fab fa-twitter"></a>
                    <a href="#" class="fab fa-facebook-square"></a>
                    <a href="#" class="fab fa-pinterest-p"></a>
                    <a href="#" class="fab fa-instagram"></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Popup -->
    <div class="search-popup">
        <div class="search-popup__overlay search-toggler"></div>
        <div class="search-popup__content">
            <form action="#">
                <label for="search" class="sr-only">search here</label>
                <input type="text" id="search" placeholder="Search Here..." />
                <button type="submit" aria-label="search submit" class="thm-btn">
                    <i class="icon-magnifying-glass"></i>
                </button>
            </form>
        </div>
    </div>

    <a href="#" data-target="html" class="scroll-to-target scroll-to-top"><i class="icon-right-arrow"></i></a>

    <!-- Scripts -->
    <script src="{% static 'assets/vendors/jquery/jquery-3.6.0.min.js' %}"></script>
    <script src="{% static 'assets/vendors/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jarallax/jarallax.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-ajaxchimp/jquery.ajaxchimp.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-appear/jquery.appear.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-circle-progress/jquery.circle-progress.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-magnific-popup/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-validate/jquery.validate.min.js' %}"></script>
    <script src="{% static 'assets/vendors/nouislider/nouislider.min.js' %}"></script>
    <script src="{% static 'assets/vendors/odometer/odometer.min.js' %}"></script>
    <script src="{% static 'assets/vendors/swiper/swiper.min.js' %}"></script>
    <script src="{% static 'assets/vendors/owl-carousel/owl.carousel.min.js' %}"></script>
    <script src="{% static 'assets/vendors/bootstrap-select/js/bootstrap-select.min.js' %}"></script>
    <script src="{% static 'assets/vendors/jquery-ui/jquery-ui.js' %}"></script>
    <script src="{% static 'assets/vendors/timepicker/timePicker.js' %}"></script>
    <script src="{% static 'assets/js/qrowd.js' %}"></script>
</body>

</html>
